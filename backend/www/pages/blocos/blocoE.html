<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" href="../css/blocos/bloco.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/blocos/calendario_modal.css">
    <script src="../js/main.js"></script>
    <title>Bloco E</title>


</head>


<body>
    <main>
        <!-- Modal Editar Palavra-Passe -->
        <div id="modal_sala" class="modal">

            <div class="modal_sala_content">
                <div class="modal-header">
                    <span id="fechar_editar" class="fechar_editar">&times;</span>
                </div>
                <h1>Horário</h1>

                <div id="horario">
                    <div style="display: flex; justify-content: center; align-items: center;">
                        <button class="icon-button" onclick="prevMonth()"><span class="material-symbols-outlined">
                                arrow_back_ios
                            </span></button>
                        <div id="monthLabel" class="month-label"></div>
                        <button class="icon-button" onclick="nextMonth()"><span class="material-symbols-outlined">
                                arrow_forward_ios
                            </span></button>

                    </div>

                    <div id="calendar" class="calendar">
                    </div>

                </div>

                <form method="post">
                    <table class="table_alunos" id="horario_sala">
                        <thead>
                            <tr class="tr_alunos">
                                <th style="width: 200px;">dia</th>
                                <th style="width: 200px;">08:00 - 08:30</th>
                                <th style="width: 200px;">08:30 - 09:00</th>
                                <th style="width: 200px;">09:00 - 09:30</th>
                                <th style="width: 200px;">09:30 - 10:00</th>
                                <th style="width: 200px;">10:00 - 10:30</th>
                                <th style="width: 200px;">10:30 - 11:00</th>
                                <th style="width: 200px;">11:00 - 11:30</th>
                                <th style="width: 200px;">11:30 - 12:00</th>
                                <th style="width: 200px;">12:00 - 12:30</th>
                                <th style="width: 200px;">12:30 - 13:00</th>
                                <th style="width: 200px;">13:00 - 13:30</th>
                                <th style="width: 200px;">13:30 - 14:00</th>
                                <th style="width: 200px;">14:00 - 14:30</th>
                                <th style="width: 200px;">14:30 - 15:00</th>
                                <th style="width: 200px;">15:00 - 15:30</th>
                                <th style="width: 200px;">15:30 - 16:00</th>
                                <th style="width: 200px;">16:00 - 16:30</th>
                                <th style="width: 200px;">16:30 - 17:00</th>
                                <th style="width: 200px;">17:00 - 17:30</th>
                                <th style="width: 200px;">17:30 - 18:00</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr id="segunda" class="tr_alunos linha-dia">
                                <td>segunda</td>
                                <td id="table_aula_segunda_08_00"></td>
                                <td id="table_aula_segunda_08_30"></td>
                                <td id="table_aula_segunda_09_00"></td>
                                <td id="table_aula_segunda_09_30"></td>
                                <td id="table_aula_segunda_10_00"></td>
                                <td id="table_aula_segunda_10_30"></td>
                                <td id="table_aula_segunda_11_00"></td>
                                <td id="table_aula_segunda_11_30"></td>
                                <td id="table_aula_segunda_12_00"></td>
                                <td id="table_aula_segunda_12_30"></td>
                                <td id="table_aula_segunda_13_00"></td>
                                <td id="table_aula_segunda_13_30"></td>
                                <td id="table_aula_segunda_14_00"></td>
                                <td id="table_aula_segunda_14_30"></td>
                                <td id="table_aula_segunda_15_00"></td>
                                <td id="table_aula_segunda_15_30"></td>
                                <td id="table_aula_segunda_16_00"></td>
                                <td id="table_aula_segunda_16_30"></td>
                                <td id="table_aula_segunda_17_00"></td>
                                <td id="table_aula_segunda_17_30"></td>

                            </tr>
                            <tr id="terca" class="tr_alunos linha-dia">
                                <td>terça</td>
                                <td id="table_aula_terca_08_00"></td>
                                <td id="table_aula_terca_08_30"></td>
                                <td id="table_aula_terca_09_00"></td>
                                <td id="table_aula_terca_09_30"></td>
                                <td id="table_aula_terca_10_00"></td>
                                <td id="table_aula_terca_10_30"></td>
                                <td id="table_aula_terca_11_00"></td>
                                <td id="table_aula_terca_11_30"></td>
                                <td id="table_aula_terca_12_00"></td>
                                <td id="table_aula_terca_12_30"></td>
                                <td id="table_aula_terca_13_00"></td>
                                <td id="table_aula_terca_13_30"></td>
                                <td id="table_aula_terca_14_00"></td>
                                <td id="table_aula_terca_14_30"></td>
                                <td id="table_aula_terca_15_00"></td>
                                <td id="table_aula_terca_15_30"></td>
                                <td id="table_aula_terca_16_00"></td>
                                <td id="table_aula_terca_16_30"></td>
                                <td id="table_aula_terca_17_00"></td>
                                <td id="table_aula_terca_17_30"></td>

                            </tr>
                            <tr id="quarta" class="tr_alunos linha-dia">
                                <td>quarta</td>
                                <td id="table_aula_quarta_08_00"></td>
                                <td id="table_aula_quarta_08_30"></td>
                                <td id="table_aula_quarta_09_00"></td>
                                <td id="table_aula_quarta_09_30"></td>
                                <td id="table_aula_quarta_10_00"></td>
                                <td id="table_aula_quarta_10_30"></td>
                                <td id="table_aula_quarta_11_00"></td>
                                <td id="table_aula_quarta_11_30"></td>
                                <td id="table_aula_quarta_12_00"></td>
                                <td id="table_aula_quarta_12_30"></td>
                                <td id="table_aula_quarta_13_00"></td>
                                <td id="table_aula_quarta_13_30"></td>
                                <td id="table_aula_quarta_14_00"></td>
                                <td id="table_aula_quarta_14_30"></td>
                                <td id="table_aula_quarta_15_00"></td>
                                <td id="table_aula_quarta_15_30"></td>
                                <td id="table_aula_quarta_16_00"></td>
                                <td id="table_aula_quarta_16_30"></td>
                                <td id="table_aula_quarta_17_00"></td>
                                <td id="table_aula_quarta_17_30"></td>

                            </tr>
                            <tr id="quinta" class="tr_alunos linha-dia">
                                <td>quinta</td>
                                <td id="table_aula_quinta_08_00"></td>
                                <td id="table_aula_quinta_08_30"></td>
                                <td id="table_aula_quinta_09_00"></td>
                                <td id="table_aula_quinta_09_30"></td>
                                <td id="table_aula_quinta_10_00"></td>
                                <td id="table_aula_quinta_10_30"></td>
                                <td id="table_aula_quinta_11_00"></td>
                                <td id="table_aula_quinta_11_30"></td>
                                <td id="table_aula_quinta_12_00"></td>
                                <td id="table_aula_quinta_12_30"></td>
                                <td id="table_aula_quinta_13_00"></td>
                                <td id="table_aula_quinta_13_30"></td>
                                <td id="table_aula_quinta_14_00"></td>
                                <td id="table_aula_quinta_14_30"></td>
                                <td id="table_aula_quinta_15_00"></td>
                                <td id="table_aula_quinta_15_30"></td>
                                <td id="table_aula_quinta_16_00"></td>
                                <td id="table_aula_quinta_16_30"></td>
                                <td id="table_aula_quinta_17_00"></td>
                                <td id="table_aula_quinta_17_30"></td>

                            </tr>
                            <tr id="sexta" class="tr_alunos linha-dia">
                                <td>sexta</td>
                                <td id="table_aula_sexta_08_00"></td>
                                <td id="table_aula_sexta_08_30"></td>
                                <td id="table_aula_sexta_09_00"></td>
                                <td id="table_aula_sexta_09_30"></td>
                                <td id="table_aula_sexta_10_00"></td>
                                <td id="table_aula_sexta_10_30"></td>
                                <td id="table_aula_sexta_11_00"></td>
                                <td id="table_aula_sexta_11_30"></td>
                                <td id="table_aula_sexta_12_00"></td>
                                <td id="table_aula_sexta_12_30"></td>
                                <td id="table_aula_sexta_13_00"></td>
                                <td id="table_aula_sexta_13_30"></td>
                                <td id="table_aula_sexta_14_00"></td>
                                <td id="table_aula_sexta_14_30"></td>
                                <td id="table_aula_sexta_15_00"></td>
                                <td id="table_aula_sexta_15_30"></td>
                                <td id="table_aula_sexta_16_00"></td>
                                <td id="table_aula_sexta_16_30"></td>
                                <td id="table_aula_sexta_17_00"></td>
                                <td id="table_aula_sexta_17_30"></td>

                            </tr>
                            <tr id="sabado" class="tr_alunos linha-dia">
                                <td>sabado</td>
                                <td id="table_aula_sabado_08_00"></td>
                                <td id="table_aula_sabado_08_30"></td>
                                <td id="table_aula_sabado_09_00"></td>
                                <td id="table_aula_sabado_09_30"></td>
                                <td id="table_aula_sabado_10_00"></td>
                                <td id="table_aula_sabado_10_30"></td>
                                <td id="table_aula_sabado_11_00"></td>
                                <td id="table_aula_sabado_11_30"></td>
                                <td id="table_aula_sabado_12_00"></td>
                                <td id="table_aula_sabado_12_30"></td>
                                <td id="table_aula_sabado_13_00"></td>
                                <td id="table_aula_sabado_13_30"></td>
                                <td id="table_aula_sabado_14_00"></td>
                                <td id="table_aula_sabado_14_30"></td>
                                <td id="table_aula_sabado_15_00"></td>
                                <td id="table_aula_sabado_15_30"></td>
                                <td id="table_aula_sabado_16_00"></td>
                                <td id="table_aula_sabado_16_30"></td>
                                <td id="table_aula_sabado_17_00"></td>
                                <td id="table_aula_sabado_17_30"></td>

                            </tr>
                        </tbody>
                    </table>
                    <button class="gravar" id="gravar">Gravar</button>
                </form>
            </div>
        </div>


        <div class="container">
            <nav>
                <ul>
                    <li style="margin-left: 1.3rem; margin-right: auto;"><a href="/">Inicio</a></li>
                    <li>
                        <div class="social-container">
                            <label class="switch">
                                <input id="switchon" type="checkbox" onclick="mySwitch()">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </li>
                    <li><a href="/contact">Contacto</a></li>
                    <li><a href="/eventos">Eventos</a></li>
                    <li class="adada"><a href="/perfil">Perfil</a></li>
                </ul>
            </nav>


            <a href="/"> <button class="button_back"> Voltar </button> </a>

            <h1>Bloco E</h1><br>
            <div class="cal">
                <table id="floorTable" data-room-counts="20, 14, 22" data-starting-room-numbers="102, 200, 302"
                    data-room-prefix="E" data-transition-room-number="322" data-custom-room-number="351">
                    <thead>
                        <tr>
                            <th>Pisos</th>
                            <!-- Add a colspan attribute to the header cell for rooms -->
                            <th colspan="100">Salas</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div><br><br>

            <footer>
                <p>
                    Criado <i class="fa fa-heart"></i> por
                    André Nunes, Diogo Oliveira, Gustavo Antunes, Sebastião Costa e Tiago Batista
                </p>
            </footer>
        </div>

    </main>
</body>

<script>
    window.onload = checkCookie();
    generateBlocos();

    const calendario_top = document.getElementById('fechar_editar');

    calendario_top.addEventListener('click', function (e) {
        //const table = document.getElementById('horario_sala');
        //table.innerHTML = '';
        const tds = document.querySelectorAll('td[id^="table_aula_"]');
        // Limpar o innerHTML de cada td
        tds.forEach(td => {
            td.innerHTML = '';
        });

        for (let linha of linhas) {
            linha.style.display = 'none';
        }
    });

    // Esconder todas as linhas
    let linhas = document.querySelectorAll('.linha-dia');
    for (let linha of linhas) {
        linha.style.display = 'none';
    }


    let bloco = 'Bloco E';
    let year = 2023;
    let month = 11;
    let horario = document.getElementById('horario');
    let modal = document.getElementById('modal_sala');
    let horario_sala = document.getElementById('horario_sala');
    let gravar = document.getElementById('gravar');

    // vai buscar a class do botao para fechar o modal
    var span = document.getElementsByClassName("fechar_editar")[0];

    //fecha o modal quando o botao dentro do modal for clicado
    span.onclick = function () {
        modal.style.display = "none";
        horario_sala.style.display = 'none';
        gravar.style.display = 'none';
        horario.style.display = "grid";
    }

    function generateCalendarModal() {
        const today = new Date();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const firstDay = new Date(year, month, 1).getDay();
        const calendarContainer = document.getElementById('calendar');
        calendarContainer.innerHTML = '';

        // Add days of the week
        const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
        daysOfWeek.forEach(day => {
            const dayElement = document.createElement('div');
            dayElement.classList.add('week');
            dayElement.textContent = day;
            calendarContainer.appendChild(dayElement);
        });

        // Add empty cells for days before the first day of the month
        for (let i = 0; i < firstDay; i++) {
            const emptyCell = document.createElement('div');
            emptyCell.classList.add('day');
            emptyCell.textContent = '';
            calendarContainer.appendChild(emptyCell);
        }

        // Add days of the month with distinctive IDs and click event listener
        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.classList.add('day');
            dayElement.textContent = day;
            dayElement.id = `${year}-${month + 1}-${day}`;

            dayElement.addEventListener('click', () => {
                horario.style.display = "none";
                horario_sala.style.display = 'block';

                clickedDayId = dayElement.id;
                console.log(clickedDayId);

                sendIdsToServer(bloco, clickedCellId, clickedDayId);

            });

            calendarContainer.appendChild(dayElement);
        }

        // Add empty cells for days after the last day of the month
        const lastDay = new Date(year, month, daysInMonth).getDay();
        const remainingEmptyCells = 7 - ((firstDay + daysInMonth) % 7);

        for (let i = 0; i < remainingEmptyCells; i++) {
            const emptyCell = document.createElement('div');
            emptyCell.classList.add('empty-day');
            emptyCell.textContent = '1';
            calendarContainer.appendChild(emptyCell);
        }

        // Update the month label
        const monthLabel = document.getElementById('monthLabel');
        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        monthLabel.textContent = `${monthNames[month]} ${year}`;
    }

    function nextMonth() {
        month++;
        if (month > 11) {
            month = 0;
            year++;
        }
        generateCalendarModal(year, month);
    }

    function prevMonth() {
        month--;
        if (month < 0) {
            month = 11;
            year--;
        }
        generateCalendarModal(year, month);
    }

    generateCalendarModal(year, month);
</script>

</html>