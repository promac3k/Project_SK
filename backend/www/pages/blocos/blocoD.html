<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" href="../css/blocos/bloco.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/blocos/calendario_modal.css">
    <script src="../js/main.js"></script>
    <script src="../js/dropdown.js"></script>
    <title>Bloco D</title>


</head>


<body>
    <main>

        <div id="modal_sala" class="modal">
            <div class="modal_sala_content">

                <div class="modal-header">
                    <span id="fechar_editar" class="fechar_editar">&times;</span>
                </div>

                <h1>Horário</h1>

                <div id="horario">
                    <div style="display: flex; justify-content: center; align-items: center;">
                        <button class="icon-button" onclick="prevMonth()"><span class="material-symbols-outlined">
                                arrow_back_ios
                            </span></button>
                        <div id="monthLabel" class="month-label"></div>
                        <button class="icon-button" onclick="nextMonth()"><span class="material-symbols-outlined">
                                arrow_forward_ios
                            </span></button>

                    </div>

                    <div id="calendar" class="calendar">
                    </div>

                </div>

                <table class="table_alunos" id="horario_sala">
                    <thead>
                        <tr class="tr_alunos">
                            <th style="width: 150px;">Dia</th>
                            <th style="width: 150px;">08:00</th>
                            <th style="width: 150px;">08:30</th>
                            <th style="width: 150px;">09:00</th>
                            <th style="width: 150px;">09:30</th>
                            <th style="width: 150px;">10:00</th>
                            <th style="width: 150px;">10:30</th>
                            <th style="width: 150px;">11:00</th>
                            <th style="width: 150px;">11:30</th>
                            <th style="width: 150px;">12:00</th>
                            <th style="width: 150px;">12:30</th>
                            <th style="width: 150px;">13:00</th>
                            <th style="width: 150px;">13:30</th>
                            <th style="width: 150px;">14:00</th>
                            <th style="width: 150px;">14:30</th>
                            <th style="width: 150px;">15:00</th>
                            <th style="width: 150px;">15:30</th>
                            <th style="width: 150px;">16:00</th>
                            <th style="width: 150px;">16:30</th>
                            <th style="width: 150px;">17:00</th>
                            <th style="width: 150px;">17:30</th>
                            <th style="width: 150px;">18:00</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr id="segunda" class="tr_alunos linha-dia">
                            <td>segunda</td>
                            <td id="table_aula_segunda_08_00"></td>
                            <td id="table_aula_segunda_08_30"></td>
                            <td id="table_aula_segunda_09_00"></td>
                            <td id="table_aula_segunda_09_30"></td>
                            <td id="table_aula_segunda_10_00"></td>
                            <td id="table_aula_segunda_10_30"></td>
                            <td id="table_aula_segunda_11_00"></td>
                            <td id="table_aula_segunda_11_30"></td>
                            <td id="table_aula_segunda_12_00"></td>
                            <td id="table_aula_segunda_12_30"></td>
                            <td id="table_aula_segunda_13_00"></td>
                            <td id="table_aula_segunda_13_30"></td>
                            <td id="table_aula_segunda_14_00"></td>
                            <td id="table_aula_segunda_14_30"></td>
                            <td id="table_aula_segunda_15_00"></td>
                            <td id="table_aula_segunda_15_30"></td>
                            <td id="table_aula_segunda_16_00"></td>
                            <td id="table_aula_segunda_16_30"></td>
                            <td id="table_aula_segunda_17_00"></td>
                            <td id="table_aula_segunda_17_30"></td>
                            <td id="table_aula_segunda_18_00"></td>

                        </tr>
                        <tr id="terca" class="tr_alunos linha-dia">
                            <td>terça</td>
                            <td id="table_aula_terca_08_00"></td>
                            <td id="table_aula_terca_08_30"></td>
                            <td id="table_aula_terca_09_00"></td>
                            <td id="table_aula_terca_09_30"></td>
                            <td id="table_aula_terca_10_00"></td>
                            <td id="table_aula_terca_10_30"></td>
                            <td id="table_aula_terca_11_00"></td>
                            <td id="table_aula_terca_11_30"></td>
                            <td id="table_aula_terca_12_00"></td>
                            <td id="table_aula_terca_12_30"></td>
                            <td id="table_aula_terca_13_00"></td>
                            <td id="table_aula_terca_13_30"></td>
                            <td id="table_aula_terca_14_00"></td>
                            <td id="table_aula_terca_14_30"></td>
                            <td id="table_aula_terca_15_00"></td>
                            <td id="table_aula_terca_15_30"></td>
                            <td id="table_aula_terca_16_00"></td>
                            <td id="table_aula_terca_16_30"></td>
                            <td id="table_aula_terca_17_00"></td>
                            <td id="table_aula_terca_17_30"></td>
                            <td id="table_aula_terca_18_00"></td>

                        </tr>
                        <tr id="quarta" class="tr_alunos linha-dia">
                            <td>quarta</td>
                            <td id="table_aula_quarta_08_00"></td>
                            <td id="table_aula_quarta_08_30"></td>
                            <td id="table_aula_quarta_09_00"></td>
                            <td id="table_aula_quarta_09_30"></td>
                            <td id="table_aula_quarta_10_00"></td>
                            <td id="table_aula_quarta_10_30"></td>
                            <td id="table_aula_quarta_11_00"></td>
                            <td id="table_aula_quarta_11_30"></td>
                            <td id="table_aula_quarta_12_00"></td>
                            <td id="table_aula_quarta_12_30"></td>
                            <td id="table_aula_quarta_13_00"></td>
                            <td id="table_aula_quarta_13_30"></td>
                            <td id="table_aula_quarta_14_00"></td>
                            <td id="table_aula_quarta_14_30"></td>
                            <td id="table_aula_quarta_15_00"></td>
                            <td id="table_aula_quarta_15_30"></td>
                            <td id="table_aula_quarta_16_00"></td>
                            <td id="table_aula_quarta_16_30"></td>
                            <td id="table_aula_quarta_17_00"></td>
                            <td id="table_aula_quarta_17_30"></td>
                            <td id="table_aula_quarta_18_00"></td>

                        </tr>
                        <tr id="quinta" class="tr_alunos linha-dia">
                            <td>quinta</td>
                            <td id="table_aula_quinta_08_00"></td>
                            <td id="table_aula_quinta_08_30"></td>
                            <td id="table_aula_quinta_09_00"></td>
                            <td id="table_aula_quinta_09_30"></td>
                            <td id="table_aula_quinta_10_00"></td>
                            <td id="table_aula_quinta_10_30"></td>
                            <td id="table_aula_quinta_11_00"></td>
                            <td id="table_aula_quinta_11_30"></td>
                            <td id="table_aula_quinta_12_00"></td>
                            <td id="table_aula_quinta_12_30"></td>
                            <td id="table_aula_quinta_13_00"></td>
                            <td id="table_aula_quinta_13_30"></td>
                            <td id="table_aula_quinta_14_00"></td>
                            <td id="table_aula_quinta_14_30"></td>
                            <td id="table_aula_quinta_15_00"></td>
                            <td id="table_aula_quinta_15_30"></td>
                            <td id="table_aula_quinta_16_00"></td>
                            <td id="table_aula_quinta_16_30"></td>
                            <td id="table_aula_quinta_17_00"></td>
                            <td id="table_aula_quinta_17_30"></td>
                            <td id="table_aula_quinta_18_00"></td>

                        </tr>
                        <tr id="sexta" class="tr_alunos linha-dia">
                            <td>sexta</td>
                            <td id="table_aula_sexta_08_00"></td>
                            <td id="table_aula_sexta_08_30"></td>
                            <td id="table_aula_sexta_09_00"></td>
                            <td id="table_aula_sexta_09_30"></td>
                            <td id="table_aula_sexta_10_00"></td>
                            <td id="table_aula_sexta_10_30"></td>
                            <td id="table_aula_sexta_11_00"></td>
                            <td id="table_aula_sexta_11_30"></td>
                            <td id="table_aula_sexta_12_00"></td>
                            <td id="table_aula_sexta_12_30"></td>
                            <td id="table_aula_sexta_13_00"></td>
                            <td id="table_aula_sexta_13_30"></td>
                            <td id="table_aula_sexta_14_00"></td>
                            <td id="table_aula_sexta_14_30"></td>
                            <td id="table_aula_sexta_15_00"></td>
                            <td id="table_aula_sexta_15_30"></td>
                            <td id="table_aula_sexta_16_00"></td>
                            <td id="table_aula_sexta_16_30"></td>
                            <td id="table_aula_sexta_17_00"></td>
                            <td id="table_aula_sexta_17_30"></td>
                            <td id="table_aula_sexta_18_00"></td>

                        </tr>
                        <tr id="sabado" class="tr_alunos linha-dia">
                            <td>sabado</td>
                            <td id="table_aula_sabado_08_00"></td>
                            <td id="table_aula_sabado_08_30"></td>
                            <td id="table_aula_sabado_09_00"></td>
                            <td id="table_aula_sabado_09_30"></td>
                            <td id="table_aula_sabado_10_00"></td>
                            <td id="table_aula_sabado_10_30"></td>
                            <td id="table_aula_sabado_11_00"></td>
                            <td id="table_aula_sabado_11_30"></td>
                            <td id="table_aula_sabado_12_00"></td>
                            <td id="table_aula_sabado_12_30"></td>
                            <td id="table_aula_sabado_13_00"></td>
                            <td id="table_aula_sabado_13_30"></td>
                            <td id="table_aula_sabado_14_00"></td>
                            <td id="table_aula_sabado_14_30"></td>
                            <td id="table_aula_sabado_15_00"></td>
                            <td id="table_aula_sabado_15_30"></td>
                            <td id="table_aula_sabado_16_00"></td>
                            <td id="table_aula_sabado_16_30"></td>
                            <td id="table_aula_sabado_17_00"></td>
                            <td id="table_aula_sabado_17_30"></td>
                            <td id="table_aula_sabado_18_00"></td>

                        </tr>
                    </tbody>
                </table>

                <button class="gravar" id="gravar">Marcar</button>
                <button class="desmarcar" id="desmarcar">desmarcar</button>

            </div>
        </div>

        <div id="modal_teste" class="modal">
            <div class="modal_sala_content">
                <div class="modal-header">
                    <span class="fechar_editar" id="fechar">&times;</span>
                </div>

                <div class="modal-content-marcar">
                   
                        <form id="marcar-form" action="/marcar" method="post">
                            <h1 class="dropdown_campo">Marcaçao</h1>
                            <span>Disciplina</span>
                            <select id="dropdown"></select>
                            <span>Curso</span>
                            <select id="dropdownCursos"></select>
                            <span>horario inicial</span>
                            <select id="dropdownHorario"></select>
                            <span>horario final</span>
                            <select id="dropdownHorarioFinal"></select>
                            <button type="submit" id="marcar">Marcar</button>
                        </form>
                    

                    <form id="desmarcar-form" action="/desmarcar" method="post">
                        <h1 class="dropdown_campo">Desmarcaçao</h1>
                        <span>Disciplina</span>
                        <select id="dropdownDesmarcar"></select>
                        <span>Curso</span>
                        <select id="dropdownCursosDesmarcar"></select>
                        <button type="submit" id="desmarcar">Desmarcar</button>
                    </form>
                </div>
            </div>
        </div>

        <div id="modal_popup" class="modal_popup">
            <div class="modal_popup_content">
                <span id="modalText"></span>
            </div>
        </div>

        <div class="container">
            <nav class="navbar">
                <ul>
                    <li style="margin-left: 1.3rem; margin-right: auto;"><a href="/">Inicio</a></li>
                    <li>
                        <div class="social-container">
                            <label class="switch">
                                <input id="switchon" type="checkbox" onclick="mySwitch()">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </li>
                    <li><a href="/contact">Contacto</a></li>
                    <li><a href="/eventos">Eventos</a></li>
                    <li class="adada"><a href="/perfil">Perfil</a></li>
                </ul>
            </nav>


            <a href="/"> <button class="button_back"> Voltar </button> </a>

            <h1>Bloco D</h1><br>
            <div class="cal">
                <table id="floorTable" data-room-counts="21, 36, 26" data-starting-room-numbers="100, 203, 303"
                    data-room-prefix="D" data-transition-room-number="326" data-custom-room-number="351">
                    <thead>
                        <tr>
                            <th>Pisos</th>
                            <!-- Add a colspan attribute to the header cell for rooms -->
                            <th colspan="100">Salas</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div><br><br>

            <footer>
                <p>
                    Criado <i class="fa fa-heart"></i> por
                    André Nunes, Diogo Oliveira, Gustavo Antunes, Sebastião Costa e Tiago Batista
                </p>
            </footer>
        </div>

    </main>
</body>

<script>
    window.onload = checkCookie();
    window.onload = fetchUserType();
    generateBlocos();

    const calendario_top = document.getElementById('fechar_editar');
    const calendario_top2 = document.getElementById('fechar');

    calendario_top.addEventListener('click', function (e) {
        //const table = document.getElementById('horario_sala');
        //table.innerHTML = '';
        const tds = document.querySelectorAll('td[id^="table_aula_"]');
        // Limpar o innerHTML de cada td
        tds.forEach(td => {
            td.innerHTML = '';
        });

        for (let linha of linhas) {
            linha.style.display = 'none';
        }
    });

    calendario_top2.addEventListener('click', function (e) {
        //const table = document.getElementById('horario_sala');
        //table.innerHTML = '';
        const tds = document.querySelectorAll('td[id^="table_aula_"]');
        // Limpar o innerHTML de cada td
        tds.forEach(td => {
            td.innerHTML = '';
        });

        for (let linha of linhas) {
            linha.style.display = 'none';
        }
    });

    // Esconder todas as linhas
    let linhas = document.querySelectorAll('.linha-dia');
    for (let linha of linhas) {
        linha.style.display = 'none';
    }

    let bloco = 'Bloco D';
    let semana = null;
    let year = 2023;
    let month = 11;
    let horario = document.getElementById('horario');
    let modal = document.getElementById('modal_sala');
    let horario_sala = document.getElementById('horario_sala');
    let gravar = document.getElementById('gravar');
    let modal_teste = document.getElementById('modal_teste');
    let desmarcar = document.getElementById('desmarcar');
    let modal_popup = document.getElementById('modal_popup');
    let modal_popup_content = document.getElementsByClassName('modal_popup_content')[0];
    let text = document.getElementById('modalText');

    // vai buscar a class do botao para fechar o modal
    var span = document.getElementsByClassName("fechar_editar")[0];
    let fechar_marcar = document.getElementById('fechar');

    //abre outro modal ao carregar no botao gravar
    gravar.onclick = function () {
        modal.style.display = "none";
        horario_sala.style.display = 'none';
        gravar.style.display = 'none';
        horario.style.display = "grid";
        modal_teste.style.display = 'block';
        // Mostra o formulário 'marcar'
        document.getElementById('marcar-form').style.display = 'block';
        // Oculta o formulário 'desmarcar'
        document.getElementById('desmarcar-form').style.display = 'none';

    }

    desmarcar.onclick = function () {
        modal.style.display = "none";
        horario_sala.style.display = 'none';
        gravar.style.display = 'none';
        horario.style.display = "grid";
        modal_teste.style.display = 'block';
        // Mostra o formulário 'desmarcar'
        document.getElementById('desmarcar-form').style.display = 'block';
        // Oculta o formulário 'marcar'
        document.getElementById('marcar-form').style.display = 'none';
    }

    //fecha o modal quando o botao dentro do modal for clicado
    span.onclick = function () {
        const modalContent = document.querySelector('.modal_sala_content_table');
        modal.style.display = "none";
        horario_sala.style.display = 'none';
        gravar.style.display = 'none';
        horario.style.display = "grid";
        modalContent.classList.remove('modal_sala_content_table');
        modalContent.classList.add('modal_sala_content');
    }

    fechar_marcar.onclick = function () {
        modal_teste.style.display = 'none';
        document.getElementById('dropdown').selectedIndex = '0';
        document.getElementById('dropdownCursos').selectedIndex = '0';
        document.getElementById('dropdownHorario').selectedIndex = '0';
        document.getElementById('dropdownHorarioFinal').selectedIndex = '0';
        document.getElementById('dropdownDesmarcar').selectedIndex = '0';
        document.getElementById('dropdownCursosDesmarcar').selectedIndex = '0';
    }

    function generateCalendarModal() {
        const today = new Date();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const firstDay = new Date(year, month, 1).getDay();
        const calendarContainer = document.getElementById('calendar');
        calendarContainer.innerHTML = '';

        // Add days of the week
        const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
        daysOfWeek.forEach(day => {
            const dayElement = document.createElement('div');
            dayElement.classList.add('week');
            dayElement.textContent = day;
            calendarContainer.appendChild(dayElement);
        });

        // Add empty cells for days before the first day of the month
        for (let i = 0; i < firstDay; i++) {
            const emptyCell = document.createElement('div');
            emptyCell.classList.add('day');
            emptyCell.textContent = '';
            calendarContainer.appendChild(emptyCell);
        }

        // Add days of the month with distinctive IDs and click event listener
        for (let day = 1; day <= daysInMonth; day++) {
            const date = new Date(year, month, day);
            const dayElement = document.createElement('div');
            const modalContent = document.querySelector('.modal_sala_content');
            dayElement.classList.add('day');
            dayElement.textContent = day;
            dayElement.id = `${year}-${month + 1}-${day}`;

            // If the day is not Sunday, add the click event listener
            if (date.getDay() !== 0) {
                dayElement.addEventListener('click', () => {
                    horario.style.display = "none";
                    horario_sala.style.display = 'block';
                    modalContent.classList.remove('modal_sala_content');
                    modalContent.classList.add('modal_sala_content_table');

                    if (valor === 1) {
                        gravar.style.display = 'block';
                        desmarcar.style.display = 'block';
                    }

                    clickedDayId = dayElement.id;
                    console.log(clickedDayId);

                    sendIdsToServer(bloco, clickedCellId, clickedDayId);
                });
            }


            calendarContainer.appendChild(dayElement);
        }

        // Add empty cells for days after the last day of the month
        const lastDay = new Date(year, month, daysInMonth).getDay();
        const remainingEmptyCells = 7 - ((firstDay + daysInMonth) % 7);

        for (let i = 0; i < remainingEmptyCells; i++) {
            const emptyCell = document.createElement('div');
            emptyCell.classList.add('empty-day');
            emptyCell.textContent = '1';
            calendarContainer.appendChild(emptyCell);
        }

        // Update the month label
        const monthLabel = document.getElementById('monthLabel');
        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        monthLabel.textContent = `${monthNames[month]} ${year}`;
    }

    function nextMonth() {
        month++;
        if (month > 11) {
            month = 0;
            year++;
        }
        generateCalendarModal(year, month);
    }

    function prevMonth() {
        month--;
        if (month < 0) {
            month = 11;
            year--;
        }
        generateCalendarModal(year, month);
    }

    generateCalendarModal(year, month);


    // Adiciona um ouvinte de evento 'submit' ao formulário com o id 'contact-form'
    document.getElementById('marcar-form').addEventListener('submit', function (event) {
        // Previne o comportamento padrão do evento 'submit', que é recarregar a página
        event.preventDefault();

        // Obtém os valores dos campos do formulário
        var disciplina = document.getElementById('dropdown').value;
        var curso = document.getElementById('dropdownCursos').value;
        var horarioInicial = document.getElementById('dropdownHorario').value;
        var horarioFinal = document.getElementById('dropdownHorarioFinal').value;
        var bloco_ = bloco;
        var sala = clickedCellId;
        var dia = clickedDayId;

        // Crie um objeto Date com a data
        var data = new Date(dia);

        // Obtenha o dia da semana como um número entre 0 e 6
        var diaDaSemanaNumero = data.getDay();

        // Mapeie o número do dia da semana para o nome do dia da semana
        var diasDaSemana = ['domingo', 'segunda', 'terca', 'quarta', 'quinta', 'sexta', 'sabado'];
        var diaDaSemana = diasDaSemana[diaDaSemanaNumero];

        //console.log(diaDaSemana); // por exemplo, 'Quarta'

        var semana_ = semana || diaDaSemana;

        //console.log(disciplina, curso, horarioInicial, horarioFinal, bloco_, sala, dia, semana_);

        // Cria um objeto com os dados do formulário
        var data = { disciplina, curso, horarioInicial, horarioFinal, bloco_, sala, dia, semana_ };

        console.log(data);

        // Envia uma solicitação POST para o servidor
        fetch('/marcar', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data), // Converte os dados do formulário em uma string JSON
        })
            .then(response => {

                // Verifica o código de status da resposta
                if (response.status === 200) {
                    modal.style.display = "none";
                    horario_sala.style.display = 'none';
                    gravar.style.display = 'none';
                    horario.style.display = "grid";
                    modal_teste.style.display = 'none';
                    document.getElementById('dropdown').selectedIndex = '0';
                    document.getElementById('dropdownCursos').selectedIndex = '0';
                    document.getElementById('dropdownHorario').selectedIndex = '0';
                    document.getElementById('dropdownHorarioFinal').selectedIndex = '0';
                    document.getElementById('dropdownDesmarcar').selectedIndex = '0';
                    document.getElementById('dropdownCursosDesmarcar').selectedIndex = '0';
                    //console.log(response);
                    text.innerHTML = "Aula marcada com sucesso!";
                    modal_popup.style.display = 'block'
                    modal_popup_content.style.border = "1px solid green";

                    // Fecha o modal após 5 segundos
                    setTimeout(function () {
                        modal_popup.style.display = "none";
                    }, 5000);
                    return null;

                } else {
                    return response.text();
                }
            })
            .then(message => {

                if (message) {
                    text.innerHTML = message;
                    //console.log(message);
                    modal_popup.style.display = 'block'
                    modal_popup_content.style.border = "1px solid #ff4321";

                    setTimeout(function () {
                        modal_popup.style.display = "none";
                    }, 5000);
                }

            })
            .then(data => {
                // Loga o corpo da resposta no console
                console.log('Sucesso:', data);
            })
            .catch((error) => {
                // Loga qualquer erro que ocorra durante a solicitação no console
                console.error('Erro:', error);
            });
    });


    // Adiciona um ouvinte de evento 'submit' ao formulário com o id 'contact-form'
    document.getElementById('desmarcar-form').addEventListener('submit', function (event) {
        // Previne o comportamento padrão do evento 'submit', que é recarregar a página
        event.preventDefault();

        // Obtém os valores dos campos do formulário
        var disciplina = document.getElementById('dropdownDesmarcar').value;
        var curso = document.getElementById('dropdownCursosDesmarcar').value;
        var bloco_ = bloco;
        var sala = clickedCellId;
        var dia = clickedDayId;

        // Crie um objeto Date com a data
        var data = new Date(dia);

        // Obtenha o dia da semana como um número entre 0 e 6
        var diaDaSemanaNumero = data.getDay();

        // Mapeie o número do dia da semana para o nome do dia da semana
        var diasDaSemana = ['domingo', 'segunda', 'terca', 'quarta', 'quinta', 'sexta', 'sabado'];
        var diaDaSemana = diasDaSemana[diaDaSemanaNumero];

        //console.log(diaDaSemana); // por exemplo, 'Quarta'

        var semana_ = semana || diaDaSemana;

        //console.log(disciplina, curso, horarioInicial, horarioFinal, bloco_, sala, dia, semana_);

        // Cria um objeto com os dados do formulário
        var data = { disciplina, curso, bloco_, sala, dia, semana_ };

        console.log(data);

        // Envia uma solicitação POST para o servidor
        fetch('/desmarcar', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data), // Converte os dados do formulário em uma string JSON
        })
            .then(response => {

                // Verifica o código de status da resposta
                if (response.status === 200) {
                    modal.style.display = "none";
                    horario_sala.style.display = 'none';
                    gravar.style.display = 'none';
                    horario.style.display = "grid";
                    modal_teste.style.display = 'none';
                    document.getElementById('dropdown').selectedIndex = '0';
                    document.getElementById('dropdownCursos').selectedIndex = '0';
                    document.getElementById('dropdownHorario').selectedIndex = '0';
                    document.getElementById('dropdownHorarioFinal').selectedIndex = '0';
                    document.getElementById('dropdownDesmarcar').selectedIndex = '0';
                    document.getElementById('dropdownCursosDesmarcar').selectedIndex = '0';
                    const tds = document.querySelectorAll('td[id^="table_aula_"]');
                    // Limpar o innerHTML de cada td
                    tds.forEach(td => {
                        td.innerHTML = '';
                    });

                    for (let linha of linhas) {
                        linha.style.display = 'none';
                    }
                    //console.log(response);
                    text.innerHTML = "Aula desmarcada com sucesso!";
                    modal_popup.style.display = 'block'
                    modal_popup_content.style.border = "1px solid green";

                    // Fecha o modal após 5 segundos
                    setTimeout(function () {
                        modal_popup.style.display = "none";
                    }, 5000);

                    return null;

                } else {
                    return response.text();
                }
            })
            .then(message => {

                if (message) {
                    text.innerHTML = message;
                    console.log(message);
                    modal_popup.style.display = 'block'
                    modal_popup_content.style.border = "1px solid #ff4321";

                    setTimeout(function () {
                        modal_popup.style.display = "none";
                    }, 5000);
                }

            })
            .then(data => {
                // Loga o corpo da resposta no console
                console.log('Sucesso:', data);
            })
            .catch((error) => {
                // Loga qualquer erro que ocorra durante a solicitação no console
                console.error('Erro:', error);
            });
    });

</script>

</html>